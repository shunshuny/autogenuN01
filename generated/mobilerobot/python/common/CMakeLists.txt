
# This file was automatically generated by autogenu-jupyter (https://github.com/mayataka/autogenu-jupyter). 
# The autogenu-jupyter copyright holders make no ownership claim of its contents. 

macro(pybind11_add_cgmres_module MODULE)
  pybind11_add_module(
    ${MODULE} 
    SHARED 
    ${MODULE}.cpp
  )
  target_include_directories(
    ${MODULE} 
    PRIVATE
    ${CGMRES_INCLUDE_DIR}
    ${CGMRES_INCLUDE_DIR}/cgmres/thirdparty/eigen
    ${CGMRES_INCLUDE_DIR}/cgmres/thirdparty/pybind11
    ${PROJECT_SOURCE_DIR}
  )
    if (VECTORIZE)
    target_compile_options(
        ${MODULE}
        PRIVATE
        -march=native
    )
    endif()
endmacro()

add_subdirectory(${CGMRES_INCLUDE_DIR}/cgmres/thirdparty/pybind11 ${CMAKE_CURRENT_BINARY_DIR}/thirdparty/pybind11)
pybind11_add_cgmres_module(solver_settings)
pybind11_add_cgmres_module(horizon)
pybind11_add_cgmres_module(timer)

set(CGMRES_PYTHON_VERSION ${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR})
set(CGMRES_PYTHON_BINDINGS_LIBDIR $ENV{HOME}/.local/lib/python${CGMRES_PYTHON_VERSION}/site-packages/cgmres/common)
file(GLOB PYTHON_BINDINGS_${CURRENT_MODULE_DIR} ${CMAKE_CURRENT_BINARY_DIR}/*.cpython*)
file(GLOB PYTHON_FILES_${CURRENT_MODULE_DIR} ${CMAKE_CURRENT_SOURCE_DIR}/*.py)
install(
  FILES ${PYTHON_FILES_${CURRENT_MODULE_DIR}} ${PYTHON_BINDINGS_${CURRENT_MODULE_DIR}} 
  DESTINATION ${CGMRES_PYTHON_BINDINGS_LIBDIR}/${CURRENT_MODULE_DIR}
)
